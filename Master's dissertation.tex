\documentclass[a4paper,12pt,russian]{extreport}

\usepackage[14pt]{extsizes} %чтобы был 14-й шрифт		
\usepackage{polyglossia}   %% загружает пакет многоязыковой вёрстки
\setdefaultlanguage{russian}  %% устанавливает главный язык документа
\setotherlanguage{english} %% объявляет второй язык документа
\defaultfontfeatures{Ligatures={TeX}}  %% свойства шрифтов по умолчанию
\setmainfont[Ligatures={TeX,Historic}]{Times New Roman} %% задаёт основной шрифт документа
\setsansfont{Arial}                    %% задаёт шрифт без засечек
\setmonofont{Courier New}               %% задаёт моноширинный шрифт
\newfontfamily{\cyrillicfonttt}{Courier New} % моноширинный шрифт, на который не ругается компилятор
\usepackage{cmap}

%%%%%%%%%%%%%%%%%%%%%%%Images
\usepackage{graphicx}
\graphicspath{{images/}} 	%Папка куда надо складывать фото относительно root
\usepackage{epstopdf} 		%Для конвертации eps фото в pdf в includegraphics
%%%%%%%%%%%%%%%%%%%%%%%Images

\usepackage{amsmath, amsthm, amsfonts}
\usepackage{indentfirst}
\usepackage[usenames,dvipsnames]{color}
\usepackage[table,xcdraw]{xcolor}
\usepackage{makecell}
\usepackage{multirow}
\usepackage{float} %for absolute positioning of photos and etc.
\usepackage{ulem}
\usepackage{tocloft}
\usepackage{import}
\usepackage{lastpage}
\usepackage{etoolbox}
\usepackage[title,titletoc]{appendix}
\usepackage{pdfpages}

%%%%%%%%%%%%%%%%%%%%%%%Listings%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{color}
\definecolor{deepblue}{rgb}{0,0,0.5}
\definecolor{deepred}{rgb}{0.6,0,0}
\definecolor{deepgreen}{rgb}{0,0.4,0}
\definecolor{mygreen}{RGB}{28,172,0} % color values Red, Green, Blue
\definecolor{mylilas}{RGB}{170,55,241}

\usepackage{listings}

\lstset{
	language=Python,
	otherkeywords={self},   % Any extra options here
	keywordstyle=\color{deepred},
	showstringspaces=false,
	stringstyle=\color{deepgreen},
	%frame=tb,   %frame
	commentstyle=\color{deepgreen}
}

\lstset{language=Matlab,
	%breaklines=true,%
	morekeywords={matlab2tikz},
	keywordstyle=\color{blue},%
	identifierstyle=\color{black},%
	stringstyle=\color{mylilas},
	commentstyle=\color{mygreen},%
	showstringspaces=false,%without this there will be a symbol in the places where there is a space
	numbers=left,%
	numbersep=9pt % this defines how far the numbers are from the text
}

%%%%%%%%%%%%%%%%%%%%%%%Listings%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{todonotes}
\usepackage{xr}
\usepackage{dsfont}
\usepackage{algorithm2e}

\usepackage[font=it]{caption}
\usepackage{fancyhdr}
%\pagestyle{fancy}
%\fancyhf{}
%\fancyhead[R]{\thepage}
%\fancyheadoffset{0mm}
%\fancyfootoffset{0mm}
\setlength{\headheight}{17pt}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
%\fancypagestyle{plain}{
%	\fancyhf{}
%	\rhead{\thepage}}
%\setcounter{page}{5}

\linespread{1.3}
\frenchspacing

%%% to allow custom headings
\usepackage{titlesec}
% to change titles font family
\usepackage{titling}

\titleformat{\chapter}[display]
	{\filcenter}
	{\MakeUppercase{\chaptertitlename} \thechapter}
	{8pt}
	{\bfseries}{}
	
\titleformat{\paragraph}[display]
	{\filcenter}
	{\MakeUppercase{\chaptertitlename} \thechapter}
	{8pt}
	{\bfseries}{}
	
\titleformat{\section}
	{\normalsize\bfseries}
	{\thesection}
	{1em}{}

\titleformat{\subsection}
	{\normalsize\bfseries}
	{\thesubsection}
	{1em}{}
	
\titlespacing*{\chapter}{0pt}{-30pt}{8pt}
\titlespacing*{\paragraph}{0pt}{-30pt}{8pt}
\titlespacing*{\section}{\parindent}{*4}{*4}
\titlespacing*{\subsection}{\parindent}{*4}{*4}

\renewcommand{\cfttoctitlefont}{\hspace{0.38\textwidth} \bfseries\MakeUppercase}
\renewcommand{\cftbeforetoctitleskip}{-1em}
\renewcommand{\cftaftertoctitle}{\mbox{}\hfill \\ \mbox{}\hfill{\footnotesize Стр.}\vspace{-2.5em}}
\renewcommand{\cftchapfont}{\normalsize\bfseries \MakeUppercase{\chaptername} }
\renewcommand{\cftsecfont}{\hspace{31pt}}
\renewcommand{\cftsubsecfont}{\hspace{11pt}}
\renewcommand{\cftbeforechapskip}{1em}
\renewcommand{\cftparskip}{-1mm}
\renewcommand{\cftdotsep}{1}
\setcounter{tocdepth}{2}
\setcounter{secnumdepth}{5}

\usepackage[square, numbers, sort&compress]{natbib}

\makeatletter
\renewcommand{\@dotsep}{2}
\newcommand{\l@likechapter}[2]{{\bfseries\@dottedtocline{0}{0pt}{0pt}{#1}{#2}}}

\newcommand{\likechapterheading}[1]{
	\begin{center}
	\textbf{\MakeUppercase{#1}}
	\end{center}
	\empline}
\newcommand{\likechapter}[1]{	
	\phantomsection
	\likechapterheading{#1}	
	\addcontentsline{toc}{likechapter}{\texorpdfstring{\MakeUppercase{#1}}{#1}}}


%%%%%%%%%%%%%%%Список литературы


%\bibliographystyle{unsrt}

\newcommand{\empline}{\mbox{}\newline}
\renewcommand{\bibnumfmt}[1]{#1.\hfill}
%\renewcommand{\bibnumfmt}[1]{[#1]\hfill}
\renewcommand{\bibsection}{\likechapter{Список литературы}}
\setlength{\bibsep}{0pt}
%%%%%%%%%%%%%%%Список литературы

\newcommand{\append}[1]{
	\clearpage
	\stepcounter{chapter}	
	\paragraph{\MakeUppercase{#1}}
	\empline
	\addcontentsline{toc}{likechapter}{\texorpdfstring{\chaptertitlename~\Asbuk{chapter}\;#1}}{\chaptertitlename~\Asbuk{chapter}:~#1}}
	
\usepackage{geometry}
\geometry{left=25mm}
\geometry{right=10mm}
\geometry{top=20mm}
\geometry{bottom=20mm}

%Таблицы и рисунки (формат подписи)
\usepackage[tableposition=top]{caption}
\usepackage{subcaption}
\DeclareCaptionLabelFormat{gostfigure}{Рисунок #2}
\DeclareCaptionLabelFormat{gosttable}{Таблица #2}
\DeclareCaptionLabelSeparator{gost}{~---~}
\captionsetup{labelsep=gost}
\captionsetup[figure]{labelformat=gostfigure}
\captionsetup[table]{labelformat=gosttable}
\renewcommand{\thesubfigure}{\asbuk{subfigure}}

\usepackage[xetex,bookmarks=true,colorlinks=true,linkcolor=blue,citecolor=Green,linktoc=none]{hyperref} 
\newcommand{\term}[1]{\textit{#1}}
\newcommand{\bydef}{\ensuremath{\stackrel{\text{\upshape df}}{=}}}
\newcommand{\<}{\langle}
\renewcommand{\>}{\rangle}
\newcommand{\includechapter}[1]{\subimport{chapter_#1/}{chapter_#1}}

\newtheorem{theorem}{Теорема}
\newtheoremstyle{break}
  {\topsep}{\topsep}%
  {\itshape}{}%
  {\bfseries}{}%
  {\newline}{}%
\theoremstyle{break}

\newtheorem{definition}{Определение}
\newtheorem{corollary*}{Следствие}
\newtheorem{lemma}{Лемма}

\newcommand{\condset}[2]{\braces{\, #1 \mid #2 \,}}
\newcommand{\walls}[1]{\left | #1 \right |} 
\newcommand{\norm}[2]{\left{||}#1\right{||}_{#2}} 
\newcommand{\set}[1]{\left\{ #1 \right\}}
\newcommand{\inprod}[3]{\left < #1,#2\right >_#3}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}

\begin{document}
\input{title}
\input{taskpage}
\input{referat}

\newpage\tableofcontents
\newpage\input{intro}

\newpage\input{textblock1}
\newpage\input{textblock2} 

\newpage
\bibliographystyle{ugost2008}%% стилевой файл для оформления по ГОСТу 
\bibliography{ref}     %% имя библиографической базы (bib-файла) 

\newpage\input{appendix} 

\end{document}
